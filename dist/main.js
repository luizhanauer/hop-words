(function(){"use strict";class a{constructor(t){this.quizzes=t}findByWord(t){const e=this.quizzes.filter(n=>n.matchesWord(t));return this.returnFirstOrNull(e)}getRandom(){return this.returnRandomOrNull(this.quizzes.length)}returnFirstOrNull(t){return t.length===0?null:t[0]}returnRandomOrNull(t){if(t===0)return null;const e=Math.floor(Math.random()*t);return this.quizzes[e]}}class c{constructor(t,e){this.targetWord=t,this.options=e}matchesWord(t){return this.targetWord.matches(t)}provideQuestionText(){return`Qual a traduÃ§Ã£o de: ${this.targetWord.display()}?`}executeOnOptions(t){this.options.forEach(t)}}class d{constructor(t,e){this.text=t,this.isCorrectOption=e}checkIsCorrect(){return this.isCorrectOption}display(){return this.text.display()}}class o{constructor(t){this.value=t}matches(t){return this.value.toLowerCase()===t.value.toLowerCase()}display(){return this.value}}class l{constructor(t){this.endpoint=t}async loadAll(){const e=await(await fetch(this.endpoint)).json();return this.mapToDomain(e)}mapToDomain(t){const e=t.map(n=>this.createQuizFromItem(n));return new a(e)}createQuizFromItem(t){const e=new o(t.word),n=t.options.map(i=>new d(new o(i.text),i.isCorrect));return new c(e,n)}}class u{constructor(){this.container=document.createElement("div"),this.applyStyles(),document.body.appendChild(this.container)}applyStyles(){Object.assign(this.container.style,{position:"absolute",background:"#fff",border:"1px solid #ccc",padding:"15px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:"999999",fontFamily:"sans-serif",display:"none"})}showAt(t,e){this.container.style.left=`${t}px`,this.container.style.top=`${e}px`,this.container.style.display="block"}hide(){this.container.style.display="none"}containsTarget(t){return t?this.container.contains(t):!1}renderQuiz(t,e){this.clearContainer(),this.renderTitle(t.provideQuestionText()),t.executeOnOptions(n=>this.renderOption(n,e))}showFeedback(t,e){this.clearContainer(),this.renderFeedbackMessage(t),this.renderNextButton(e),this.renderCloseButton()}clearContainer(){this.container.innerHTML=""}renderTitle(t){const e=document.createElement("h4");e.textContent=t,e.style.margin="0 0 10px 0",this.container.appendChild(e)}renderOption(t,e){const n=document.createElement("button");n.textContent=t.display(),n.style.display="block",n.style.width="100%",n.style.marginBottom="8px",n.style.padding="8px",n.style.cursor="pointer",n.addEventListener("click",()=>e(t.checkIsCorrect())),this.container.appendChild(n)}renderFeedbackMessage(t){const e=document.createElement("div");e.textContent=t?"ðŸŽ‰ Acertou!":"âŒ Errou!",e.style.color=t?"green":"red",e.style.fontWeight="bold",e.style.marginBottom="10px",this.container.appendChild(e)}renderNextButton(t){const e=document.createElement("button");e.textContent="PrÃ³xima Palavra AleatÃ³ria",e.style.marginRight="5px",e.addEventListener("click",t),this.container.appendChild(e)}renderCloseButton(){const t=document.createElement("button");t.textContent="Fechar",t.addEventListener("click",()=>this.hide()),this.container.appendChild(t)}}class h{constructor(t,e){this.repository=t,this.ui=e}async initialize(){const t=await this.repository.loadAll();this.attachEventListeners(t)}attachEventListeners(t){document.addEventListener("dblclick",e=>this.handleTextSelection(e,t)),document.addEventListener("mousedown",e=>this.hideUiIfClickedOutside(e))}handleTextSelection(t,e){const n=window.getSelection(),i=(n==null?void 0:n.toString().trim())||"";this.processSelectedText(i,t,e)}processSelectedText(t,e,n){if(!t)return;const i=new o(t),r=n.findByWord(i);this.displayQuizIfFound(r,n,e.pageX,e.pageY)}displayQuizIfFound(t,e,n,i){t&&(this.ui.renderQuiz(t,r=>{this.ui.showFeedback(r,()=>this.showRandomQuiz(e,n,i))}),this.ui.showAt(n,i+15))}showRandomQuiz(t,e,n){const i=t.getRandom();this.displayQuizIfFound(i,t,e,n)}hideUiIfClickedOutside(t){const e=this.ui.containsTarget(t.target);this.executeHideIfNotInside(e)}executeHideIfNotInside(t){t||this.ui.hide()}}const p="https://luizhanauer.github.io/hop-words/words.json";new h(new l(p),new u).initialize()})();
