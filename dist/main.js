var x=Object.defineProperty;var g=(r,o,a)=>o in r?x(r,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[o]=a;var d=(r,o,a)=>g(r,typeof o!="symbol"?o+"":o,a);(function(){"use strict";class r{constructor(t,e){this.text=t,this.isCorrect=e}display(){return this.text.toString()}checkIsCorrect(){return this.isCorrect}}class o{constructor(t,e){this.word=t,this.options=e}provideQuestionText(){return`Qual a traduÃ§Ã£o de: ${this.word.toString()}?`}executeOnOptions(t){this.options.forEach(t)}isMatch(t){return this.word.equals(t)}}class a{constructor(t){this.quizzes=t}findByWord(t){return this.quizzes.find(e=>e.isMatch(t))||null}getRandom(){if(this.quizzes.length===0)return null;const t=Math.floor(Math.random()*this.quizzes.length);return this.quizzes[t]}}class l{constructor(t){d(this,"value");if(!t||t.trim().length===0)throw new Error("O texto da palavra nÃ£o pode estar vazio.");this.value=t.trim().toLowerCase()}equals(t){return this.value===t.toString()}toString(){return this.value}}class u{constructor(t){this.url=t}async loadAll(){const t=await fetch(this.url);if(!t.ok)throw new Error("Falha ao carregar API");const n=(await t.json()).map(s=>{const i=s.options.map(h=>new r(new l(h.text),h.isCorrect));return new o(new l(s.word),i)});return new a(n)}}class p{constructor(){d(this,"container");this.container=document.createElement("div"),this.applyStyles(),document.body.appendChild(this.container)}applyStyles(){Object.assign(this.container.style,{position:"absolute",background:"#ffffff",border:"1px solid #e0e0e0",padding:"16px",borderRadius:"12px",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",zIndex:"2147483647",fontFamily:"'Segoe UI', Roboto, Helvetica, Arial, sans-serif",display:"none",minWidth:"200px"})}showAt(t,e){this.container.style.left=`${t}px`,this.container.style.top=`${e}px`,this.container.style.display="block"}hide(){this.container.style.display="none"}containsTarget(t){return t instanceof Node&&this.container.contains(t)}renderQuiz(t,e){this.clearContainer();const n=this.createTitle(t.provideQuestionText());this.container.appendChild(n),t.executeOnOptions(s=>{const i=this.createOptionButton(s,e);this.container.appendChild(i)})}showFeedback(t,e){this.clearContainer();const n=this.createFeedbackMessage(t),s=this.createButton("PrÃ³xima Palavra",e,"#4CAF50","#fff"),i=this.createButton("Fechar",()=>this.hide(),"#f44336","#fff");this.container.appendChild(n),this.container.appendChild(s),this.container.appendChild(i)}clearContainer(){for(;this.container.firstChild;)this.container.removeChild(this.container.firstChild)}createTitle(t){const e=document.createElement("h4");return e.textContent=t,e.style.margin="0 0 12px 0",e.style.color="#333",e}createOptionButton(t,e){const n=this.createButton(t.display(),()=>e(t.checkIsCorrect()));return n.style.width="100%",n.style.marginBottom="8px",n}createFeedbackMessage(t){const e=document.createElement("div");return e.textContent=t?"ðŸŽ‰ Excelente!":"âŒ Quase lÃ¡!",e.style.color=t?"#2e7d32":"#d32f2f",e.style.fontWeight="bold",e.style.marginBottom="12px",e.style.textAlign="center",e}createButton(t,e,n="#f0f0f0",s="#333"){const i=document.createElement("button");return i.textContent=t,i.style.padding="8px 12px",i.style.border="none",i.style.borderRadius="6px",i.style.cursor="pointer",i.style.backgroundColor=n,i.style.color=s,i.style.fontWeight="500",i.style.marginRight="4px",i.style.transition="filter 0.2s",i.onmouseover=()=>{i.style.filter="brightness(0.9)"},i.onmouseout=()=>{i.style.filter="brightness(1)"},i.onclick=e,i}}class f{constructor(t,e){this.repository=t,this.ui=e}async initialize(){const t=await this.repository.loadAll();this.attachEventListeners(t)}attachEventListeners(t){document.addEventListener("dblclick",e=>this.handleTextSelection(e,t)),document.addEventListener("mousedown",e=>this.hideUiIfClickedOutside(e))}handleTextSelection(t,e){const n=window.getSelection(),s=(n==null?void 0:n.toString().trim())||"";this.processSelectedText(s,t,e)}processSelectedText(t,e,n){if(!t)return;const s=new l(t),i=n.findByWord(s);this.displayQuizIfFound(i,n,e.pageX,e.pageY)}displayQuizIfFound(t,e,n,s){t&&(this.ui.renderQuiz(t,i=>{this.ui.showFeedback(i,()=>this.showRandomQuiz(e,n,s))}),this.ui.showAt(n,s+15))}showRandomQuiz(t,e,n){const s=t.getRandom();this.displayQuizIfFound(s,t,e,n)}hideUiIfClickedOutside(t){const e=this.ui.containsTarget(t.target);this.executeHideIfNotInside(e)}executeHideIfNotInside(t){t||this.ui.hide()}}const y="https://luizhanauer.github.io/hop-words/words.json";new f(new u(y),new p).initialize()})();
